<view class="track-page"><nav-bar vue-id="03bc5ca8-1" bind:__l="__l" vue-slots="{{['title']}}"><view slot="title"><view>历史足迹</view></view></nav-bar><scroll-view scroll-x="{{true}}"><view class="scenic-tabs"><block wx:for="{{scenics}}" wx:for-item="item" wx:for-index="__i0__" wx:key="scenic_id"><view data-event-opts="{{[['tap',[['setActiveScenicId',['$0'],[[['scenics','scenic_id',item.scenic_id,'scenic_id']]]]]]]}}" class="{{[(true)?'scenic-tab':'',(item.scenic_id==activeScenicId)?'scenic-tab-active':'']}}" bindtap="__e"><view class="scenic-image-container"><image class="scenic-image" src="{{item.image}}" mode="aspectFill"></image></view><view class="scenic-name">{{item.scenic_name}}</view></view></block></view></scroll-view><view class="stats-card"><view class="stats-header"><uni-icons vue-id="03bc5ca8-2" type="calendar" size="22" color="#3bcb98" bind:__l="__l"></uni-icons><text class="stats-title">行程概览</text></view><view class="stats-content"><view class="stats-item"><text class="stats-value">{{rec_num}}</text><text class="stats-label">次到访</text></view><view class="stats-divider"></view><view class="stats-item"><text class="stats-value">{{$root.m0}}</text><text class="stats-label">最近到访</text></view><view class="stats-divider"></view><view class="stats-item"><text class="stats-value">{{rec_attraction}}</text><text class="stats-label">最新景点</text></view></view></view><view class="map-container"><map class="track-map" latitude="{{selectedScenic.scenic_lat}}" longitude="{{selectedScenic.scenic_lng}}" scale="{{selectedScenic.scale}}" markers="{{markers}}" polyline="{{polylineStyle}}" show-location="true" data-event-opts="{{[['markertap',[['handleMarkerTap',['$event']]]]]}}" bindmarkertap="__e"></map><block wx:if="{{$root.g0>0}}"><view data-event-opts="{{[['tap',[['shareRoute',['$event']]]]]}}" class="share-button" bindtap="__e"><uni-icons vue-id="03bc5ca8-3" type="share" size="20" color="#ffffff" bind:__l="__l"></uni-icons></view></block><block wx:if="{{$root.g1>0}}"><view class="time-card"><view class="time-section"><view class="time-icon"><uni-icons vue-id="03bc5ca8-4" type="clock-filled" size="18" color="#3bcb98" bind:__l="__l"></uni-icons></view><view class="time-details"><text class="time-label">第一次</text><text class="time-value">{{$root.m1}}</text><text class="time-date">{{$root.m2}}</text></view></view><view class="time-divider"></view><view class="time-section"><view class="time-icon"><uni-icons vue-id="03bc5ca8-5" type="clock-filled" size="18" color="#3bcb98" bind:__l="__l"></uni-icons></view><view class="time-details"><text class="time-label">最近一次</text><text class="time-value">{{$root.m3}}</text><text class="time-date">{{$root.m4}}</text></view></view></view></block></view><block wx:if="{{showInfo}}"><view class="attraction-info-card"><view class="attraction-header"><image class="attraction-cover" src="{{selectedAttraction.image}}" mode="aspectFill"></image><view class="attraction-profile"><view class="attraction-name-row"><text class="attraction-name">{{selectedAttraction.attraction_name}}</text><uni-icons vue-id="03bc5ca8-6" type="closeempty" size="20" color="#999" data-event-opts="{{[['^click',[['e0']]]]}}" bind:click="__e" bind:__l="__l"></uni-icons></view><view class="rating"><uni-icons vue-id="03bc5ca8-7" type="star-filled" size="14" color="#ffc107" bind:__l="__l"></uni-icons><text class="rating-value">{{selectedAttraction.rating||4.5}}</text></view></view></view><view class="attraction-details"><view class="detail-item"><uni-icons vue-id="03bc5ca8-8" type="calendar-filled" size="16" color="#3bcb98" bind:__l="__l"></uni-icons><text class="detail-text">{{"游玩时间: "+selectedMarker.check_in_time}}</text></view><view class="detail-item"><uni-icons vue-id="03bc5ca8-9" type="location-filled" size="16" color="#3bcb98" bind:__l="__l"></uni-icons><text class="detail-text">{{selectedAttraction.address}}</text></view><block wx:if="{{selectedAttraction.description}}"><view class="detail-item"><uni-icons vue-id="03bc5ca8-10" type="info-filled" size="16" color="#3bcb98" bind:__l="__l"></uni-icons><text class="detail-text description">{{selectedAttraction.description}}</text></view></block></view><view class="action-buttons"><view data-event-opts="{{[['tap',[['navto_detail',['$0'],['selectedAttraction.attraction_id']]]]]}}" class="action-button details" bindtap="__e"><text>查看详情</text></view><view data-event-opts="{{[['tap',[['navigateToNavigationPage',['$0'],['selectedAttraction']]]]]}}" class="action-button navigate" bindtap="__e"><uni-icons vue-id="03bc5ca8-11" type="paperplane-filled" size="16" color="#ffffff" bind:__l="__l"></uni-icons><text>导航前往</text></view></view></view></block><canvas class="share-canvas" canvas-id="shareCanvas"></canvas></view>